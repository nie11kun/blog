<?xml version="1.0" encoding="UTF-8"?>
<rdf:RDF
xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns="http://purl.org/rss/1.0/"
xmlns:dc="http://purl.org/dc/elements/1.1/">
<channel rdf:about="https://blog.niekun.net/feed/rss/category/Windows/">
<title>Marco Nie - Windows</title>
<link>https://blog.niekun.net/category/Windows/</link>
<description></description>
<items>
<rdf:Seq>
<rdf:li resource="https://blog.niekun.net/archives/1797.html"/>
<rdf:li resource="https://blog.niekun.net/archives/1793.html"/>
<rdf:li resource="https://blog.niekun.net/archives/1788.html"/>
<rdf:li resource="https://blog.niekun.net/archives/1785.html"/>
<rdf:li resource="https://blog.niekun.net/archives/1782.html"/>
<rdf:li resource="https://blog.niekun.net/archives/1777.html"/>
<rdf:li resource="https://blog.niekun.net/archives/1632.html"/>
<rdf:li resource="https://blog.niekun.net/archives/1575.html"/>
<rdf:li resource="https://blog.niekun.net/archives/1553.html"/>
<rdf:li resource="https://blog.niekun.net/archives/1550.html"/>
</rdf:Seq>
</items>
</channel>
<item rdf:about="https://blog.niekun.net/archives/1797.html">
<title>解决 proxifier 和 wsl 2 无法同时使用的问题</title>
<link>https://blog.niekun.net/archives/1797.html</link>
<dc:date>2020-10-12T15:18:00+08:00</dc:date>
<description>今天将 Windows 10 升级到了 build 2004 版，顺便将 wsl 升级到了 wsl 2，升级教程参考：https://blog.niekun.net/archives/1785.html。运行 wsl 2 时，发现如下报错：PS C:\Users\Marco Nie&gt; wsl
The attempted operation is not supported for the type of object referenced.无法正常使用 wsl，查询后得知是由于我正在使用的 proxifier 和 wsl 有了冲突，proxifier 是我一直使用的用来代理程序的应用。在 wsl 的 github 项目讨论中看到有人问了 proxifier 开发者，得到了解决方法，需要使用提供的程序来让 wsl 在运行时不要加载 LSP DLLs。下载 NoLsp.zip，解压得到 NoLsp.exe以管理员权限运行 terminal，执行 path\to\NoLsp.exe c:\windows\system32\wsl.exe看到终端显示 Succsess!，表示操作完成，然后 wsl 系统就可以正常打开使用同时不影响 proxifier。参考链接：https://github.com/microsoft/WSL/issues/4177</description>
</item>
<item rdf:about="https://blog.niekun.net/archives/1793.html">
<title>Windows 重建图标缓存</title>
<link>https://blog.niekun.net/archives/1793.html</link>
<dc:date>2020-10-12T11:10:00+08:00</dc:date>
<description>在使用 Windows 中有时候会发现某个程序或文件的图标显示不正常，一般是图标缓存的问题，重建一下即可。以 Windows 10 为例，图标缓存文件路径为：%LOCALAPPDATA%\Microsoft\Windows\Explorer文件夹内的 iconcache_*.db 就是图标缓存文件，删除这些文件然后重启 explorer 即可。下面介绍命令的方式处理，使用 power shell 终端：# 停止 explorer 进程
taskkill /f /im explorer.exe

# 删除缓存图标文件，ps 中使用 $Env:&lt;variable-name&gt; 表达环境变量
del &quot;$env:LOCALAPPDATA\Microsoft\Windows\Explorer\iconcache*.db&quot;

# 重启 explorer
start explorer完成后查看图标是否已经正常显示。</description>
</item>
<item rdf:about="https://blog.niekun.net/archives/1788.html">
<title>Windows 常用终端命令</title>
<link>https://blog.niekun.net/archives/1788.html</link>
<dc:date>2020-10-12T09:30:00+08:00</dc:date>
<description>系统版本：winver
系统详细信息：systeminfo
当前用户名：whoami

本地网络：ipconfig
刷新 DNS 缓存：ipconfig /flushdns
路由信息：pathping
cmd 命令换行符：echo abc
等同于：
echo ^
abcpowershell 命令换行符：echo abc
等同于：
echo `
abc信息过滤：类似 Linux 的 grepfindstr
systeminfo | findstr &quot;System Type&quot;
查看命令的帮助：pathping /?
findstr /?
systeminfo /?
显示所有端口情况：netstat -ano
显示某个端口的占用情况 返回的数据中最后的数字为 PID 号：netstat -aon|findstr &quot;7200&quot;
根据 PID 号结束对应进程：taskkill /f /pid  7200
结束某个进程：taskkill /f /im explorer.exe
删除某个文件：del &quot;IconCache.db&quot;
启动某个程序：start explorer





</description>
</item>
<item rdf:about="https://blog.niekun.net/archives/1785.html">
<title>Windows 10 Linux 子系统 WSL 升级到 WSL 2</title>
<link>https://blog.niekun.net/archives/1785.html</link>
<dc:date>2020-10-12T09:24:00+08:00</dc:date>
<description>Windows 10 上的 wsl 可以方便的运行 Linux 环境，最近从 wsl 升级到了 wsl 2，看了下介绍主要区别是：increase file system performancesupport full system call compatibility增加了系统性能，更加完善的 Linux 系统环境。之前再 wsl 上无法使用的一些功能如 systemd 和网络 socket 提取的功能不知道是否可用了，下面就升级到 wsl 2 进行测试。关于 wsl 的介绍和安装可以参考我的教程：https://blog.niekun.net/archives/1148.html环境要求Requirements：For x64 systems: Version 1903 or higher, with Build 18362 or higher.For ARM64 systems: Version 2004 or higher, with Build 19041 or higher.Builds lower than 18362 do not support WSL 2. Use the Windows Update Assistant to update your version of Windows.可以使用命令查看当前系统版本，快捷键 win + R，输入 winver 弹出系统信息：命令行打开系统功能再我之前写的 wsl 安装教程里，介绍了从系统控制面板和命令行打开 Windows Subsystem for Linux 功能的方法，这里只介绍命令行方式。首先以管理员权限打开 powershell。如果之前没有安装 wsl 的话首先开启 Windows Subsystem for Linux：dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart
然后开启 Virtual Machine feature：dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart
完成以上两部后，重启系统。重启完成后安装 Linux 内核更新包：点击下载再次重启系统。设置 wsl 默认版本为 2：(管理员权限打开 powershell)wsl --set-default-version 2
设置默认版本后，以后安装的 Linux 子系统默认为 wsl 2 版本。也可以将之前安装的 Linux 子系统升级到 wsl 2：# 查看当前已安装的子系统
wsl -l -v

# 升级某个子系统到 wsl 2
wsl --set-version Ubuntu 2wsl 2 安装完成后就可以去 Windows 商店下载安装 Linux 发行版了：https://aka.ms/wslstore安装 Linux 发行版后的具体设置和之前 wsl 安装教程一样：https://blog.niekun.net/archives/1148.html参考链接https://docs.microsoft.com/en-us/windows/wsl/install-win10https://docs.microsoft.com/en-us/windows/wsl/compare-versions</description>
</item>
<item rdf:about="https://blog.niekun.net/archives/1782.html">
<title>powershell 脚本实现系统消息提醒</title>
<link>https://blog.niekun.net/archives/1782.html</link>
<dc:date>2020-09-30T11:52:07+08:00</dc:date>
<description>https://mcpmag.com/articles/2017/09/07/creating-a-balloon-tip-notification-using-powershell.aspx</description>
</item>
<item rdf:about="https://blog.niekun.net/archives/1777.html">
<title>powershell 脚本运行问题处理</title>
<link>https://blog.niekun.net/archives/1777.html</link>
<dc:date>2020-09-28T12:53:00+08:00</dc:date>
<description>最近在学习 powershell 脚本中发现如果当前目录不在 ps1 脚本所在目录的话脚本不能正常执行，研究了下如何解决。PS C:\Users\Marco Nie&gt; &quot;C:\Users\Marco Nie\Application\aria2\download-complete.ps1&quot;
C:\Users\Marco Nie\Application\aria2\download-complete.ps1如以上，我想执行脚本，但是只是返回了路径。解决方法是在脚本路径前加上程序调用符 &amp; ，表示后面的是可执行文件。 &amp;&quot;C:\Users\Marco Nie\Application\aria2\download-complete.ps1&quot;以上方式就可以正常执行脚本了。还有就是脚本路径上如果有空格的话，需要使用引号将路径包围起来，这样就可以了。参考链接：http://www.splaybow.com/post/powershell-run-command-with-space.html</description>
</item>
<item rdf:about="https://blog.niekun.net/archives/1632.html">
<title>Windows 10 无法同步设置</title>
<link>https://blog.niekun.net/archives/1632.html</link>
<dc:date>2020-07-08T17:17:00+08:00</dc:date>
<description>最近发现设置里的同步设置选项无法启用，虽然我只有这一台 Windows 电脑，但是无法打开这一功能还是让我有点别扭。经过多方搜索终于发现问题了，原来是我添加了另一个账户用来使用 office 365 导致的。在 sync your settings 里发现 sync settings 按钮是灰色的，然后上方有提示信息：sync is not available for your account, contact your system administrator to solve this.在Email & account 里可以看到我还添加了另一个 work or school account，如果添加了这个账户就会引起无法启动 sync。在 access work or school 里点击对应账户，点击 disconnect 即可退出这个账户：退出后重启系统，查看 sync 功能已经可以启用了。这样处理后就无法使用 work account 来激活 office 365 了，有点儿得不偿失。所以我在知道原因后就再次添加回来账户了。</description>
</item>
<item rdf:about="https://blog.niekun.net/archives/1575.html">
<title>VMware Workstation 虚拟机导入 VMware Fusion</title>
<link>https://blog.niekun.net/archives/1575.html</link>
<dc:date>2020-07-02T22:28:00+08:00</dc:date>
<description>在 Windows 下我一直在使用 vmware workstation pro 虚拟机，最近需要在 mac 上使用 Windows 软件，所以尝试安装虚拟机，vmware 同样有 mac 下的产品 vmware fusion，最便捷的方法就是直接导入 workstation 的到 fusion，这样就不需要重新安装系统和软件了。官网：https://www.vmware.com/products/fusion.html下载首先到官网下载最新版 vmware fusion，目前版本为 11.5：https://www.vmware.com/products/fusion/fusion-evaluation.html安装安装下载的 dmg 文件，安装过程中会要求输入序列号，请自行查找。运行 vmware fusion 需要系统 accessibility 的权限，安装完成后请到 system preference - security &amp; privacy 里打开对应权限：复制虚拟机把 Windows 下 workstation 的虚拟机文件夹复制到 mac 端，虚拟机文件夹默认在用户目录 document - Virtual Machines 文件夹内，找到需要复制的虚拟机文件夹如：windows 7,然后拷贝到 mac。复制到 mac 后给文件夹名添加后缀：.vmwarevm，如：Windows 7.vmwarevm，会自动识别为 fusion 可打开的类型。运行 vmware fusion，选择 file - open and run：在打开的对话框找到重命名后的文件夹，选择 open，会启动虚拟机，如果无法启动提示：Could not open /dev/vmmon: Broken pipe，则是由于 accessibility 权限未打开。请根据上面的方法打开权限，然后重新运行 fusion。启动后可以点击上方的设置，进行具体设置：usb 连接如果无法将 usb 挂在到虚拟机，提示不可识别的设备，则可能是由于没有打开 usb 3.0 兼容。首先关闭虚拟机，打开设置 - usb &amp; Bluetooth - advanced usb options，将下方的 usb capability 切换到 usb 3.1：重新启动虚拟机测试是否可以正常识别 usb。如果还是无法识别这可能是 windows usb 3.0 驱动没有安装，可以到 intel 官网下载驱动：下载地址进入虚拟机安装以上驱动，如果安装出错，则可能需要打 KB2533623 系统补丁，可以到微软官网下载补丁：点我下载安装好补丁后重启系统，然后安装 usb 驱动，完成后再次将 usb 设备切换到虚拟机测试是否可以正常识别到了：以上就是 Windows 下 vmware workstation 虚拟机迁移到 mac 下 vmware fusion 的方法。</description>
</item>
<item rdf:about="https://blog.niekun.net/archives/1553.html">
<title>pandownload keep alive</title>
<link>https://blog.niekun.net/archives/1553.html</link>
<dc:date>2020-04-18T21:57:00+08:00</dc:date>
<description>下载百度云的资源一直是比较头疼的，限速严重影响到了使用体验，我对百度产品又不太喜欢所以就排除了充值会员的选项。前段时间发了一篇百度云网盘直链获取及下载的文章，但是封锁很严重，基本处于不能用的状态。这两天 pandownload 这款百度盘下载器的话题很多。由于服务器被关闭，导致软件打不开。研究了下可以绕过程序启动同服务器的链接正常使用软件。原理就是利用别人备份的 pandownload.com 的网站的内容托管到别的服务器，再将对 pandownload.com 域名的请求解析到对应的服务器地址。pandownload apppandownload 只提供了 Windows 版本，这里提供程序的备份：PanDownload_add_temp.zip网站托管程序启动时会同 pandownload.com 发起请求，感谢有人对网站内容做了备份，这里只需要将网站托管到其他的服务器即可。网站备份：https://github.com/AyagawaSeirin/PandownloadFake下载仓库到服务器，使用 nginx 监听 pandownload.com 域名的访问:server {
    listen        80;
    server_name   pandownload.com;
    root          /path/PandownloadFake;
    index         index.html;

    location / {
        try_files $uri $uri/ =404;
    }
    location /api {
    }
}域名解析网站托管到新的服务器后，就可以将本地 dns 解析到服务器地址了。有很多方法可以实现，这里介绍修改 hosts 文件和 v2ray 的 dns 服务器实现。hosts修改 hosts 文件是最基本的方法，就是强制将某个域名的访问解析到对应的 IP 地址。hosts 文件地址：C:\Windows\System32\Drivers\etc\hosts打开 hosts 文件，在最后加入如下：xxx.xxx.xxx.xxx    pandownload.com
解析地址可以填写服务器 IP，如果服务器原本的域名加了 CDN，可以填写 CDN 分配的 IP，隐藏服务器真实地址。也可以直接填写域名。修改 hosts 完成后再 cmd 执行下面命令以刷新 dns 缓存：ipconfig /flushdns
启动 pandownload 查看是否可以启动。配置 v2ray dns 服务器如果正在使用 v2ray，可以配置 dns 服务器来达到同样的效果。dns 段添加设置如下：{
    &quot;dns&quot;: {
        &quot;hosts&quot;: {
            &quot;domain:pandownload.com&quot;: &quot;xxx.xxx.xxx.xxx&quot;
        }
    }
}routing 段添加设置如下：{
    &quot;routing&quot;: {
        &quot;domainStrategy&quot;: &quot;IPOnDemand&quot;,
        &quot;rules&quot;: [
            {
                &quot;type&quot;: &quot;field&quot;,
                &quot;domain&quot;: [
                    &quot;pandownload.com&quot;
                ],
                &quot;outboundTag&quot;: &quot;direct-customDNS&quot;
            }
        ]
    }
}outbounds 段添加设置如下：{
    &quot;outbounds&quot;: [
        {
            &quot;protocol&quot;: &quot;freedom&quot;,
            &quot;settings&quot;: {
                &quot;domainStrategy&quot;: &quot;UseIP&quot;
            },
            &quot;tag&quot;: &quot;direct-customDNS&quot;
        }
    ]
}以上 v2ray 配置完成后，需要让 pandownload 走 v2ray 监听的代理地址。修改 PanData\config.ini：proxy=127.0.0.1:1082
proxy 地址为 v2ray http 监听地址。启动 pandownload 测试是否启动正常。使用网上有人搭建好现成的服务端，自己搭建不方便的话可以直接使用别人搭建好的 hosts 地址：185.199.108.15364.52.84.68登录百度账户即可进行下载，这里测试需要设置为PCS接口才能正常下载：</description>
</item>
<item rdf:about="https://blog.niekun.net/archives/1550.html">
<title>Windows 自动运行脚本及自启动设置</title>
<link>https://blog.niekun.net/archives/1550.html</link>
<dc:date>2020-04-12T21:39:16+08:00</dc:date>
<description>对于 Windows 下 cmd 命令行执行的命令，可以写一个 bat 脚本，双击直接后台运行：@echo off
if &quot;%1&quot; == &quot;h&quot; goto begin
mshta vbscript:createobject(&quot;wscript.shell&quot;).run(&quot;&quot;&quot;%~nx0&quot;&quot; h&quot;,0)(window.close)&amp;&amp;exit
:begin
REM

cd C:\frp
frpc -c frpc.ini

exit上面的 cd 开始的两行示例命令修改为需要执行的命令即可，程序会在后台运行，想要关闭可以在任务管理器中找到并结束进程：frpc.exe需要注意的是需要先 cd 到执行程序目录再写运行命令，不然会出问题。将脚本快捷方式放到开机启动文件夹可以实现开机自启动，Windows 10 自启文件夹地址是：%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup</description>
</item>
</rdf:RDF>