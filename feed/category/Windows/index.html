<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
xmlns:content="http://purl.org/rss/1.0/modules/content/"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
xmlns:atom="http://www.w3.org/2005/Atom"
xmlns:wfw="http://wellformedweb.org/CommentAPI/">
<channel>
<title>Marco Nie - Windows</title>
<link>https://blog.niekun.net/category/Windows/</link>
<atom:link href="https://blog.niekun.net/feed/category/Windows/" rel="self" type="application/rss+xml" />
<language>zh-CN</language>
<description></description>
<lastBuildDate>Wed, 08 Jul 2020 17:17:00 +0800</lastBuildDate>
<pubDate>Wed, 08 Jul 2020 17:17:00 +0800</pubDate>
<item>
<title>Windows 10 无法同步设置</title>
<link>https://blog.niekun.net/archives/1632.html</link>
<guid>https://blog.niekun.net/archives/1632.html</guid>
<pubDate>Wed, 08 Jul 2020 17:17:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[最近发现设置里的同步设置选项无法启用，虽然我只有这一台 Windows 电脑，但是无法打开这一功能还是让我有点别扭。经过多方搜索终于发现问题了，原来是我添加了另一个账户用来使用 office 3...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p><img src="https://blog.niekun.net/usr/uploads/2020/07/3342140654.png" alt="2020-07-08T09:19:32.png" title="2020-07-08T09:19:32.png"></p><p>最近发现设置里的<strong>同步设置</strong>选项无法启用，虽然我只有这一台 Windows 电脑，但是无法打开这一功能还是让我有点别扭。经过多方搜索终于发现问题了，原来是我添加了另一个账户用来使用 office 365 导致的。</p><!--more--><p><img src="https://blog.niekun.net/usr/uploads/2020/07/2164031829.png" alt="2020-07-08T09:12:42.png" title="2020-07-08T09:12:42.png"><br>在 sync your settings 里发现 sync settings 按钮是灰色的，然后上方有提示信息：sync is not available for your account, contact your system administrator to solve this.</p><p><img src="https://blog.niekun.net/usr/uploads/2020/07/1859721455.png" alt="2020-07-08T09:10:35.png" title="2020-07-08T09:10:35.png"><br>在Email & account 里可以看到我还添加了另一个 work or school account，如果添加了这个账户就会引起无法启动 sync。</p><p>在 access work or school 里点击对应账户，点击 disconnect 即可退出这个账户：<br><img src="https://blog.niekun.net/usr/uploads/2020/07/753352463.png" alt="2020-07-08T09:16:04.png" title="2020-07-08T09:16:04.png"></p><p>退出后重启系统，查看 sync 功能已经可以启用了。</p><p>这样处理后就无法使用 work account 来激活 office 365 了，有点儿得不偿失。所以我在知道原因后就再次添加回来账户了。</p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/1632.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/archives/1632.html</wfw:commentRss>
</item>
<item>
<title>VMware Workstation 虚拟机导入 VMware Fusion</title>
<link>https://blog.niekun.net/archives/1575.html</link>
<guid>https://blog.niekun.net/archives/1575.html</guid>
<pubDate>Thu, 02 Jul 2020 22:28:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[在 Windows 下我一直在使用 vmware workstation pro 虚拟机，最近需要在 mac 上使用 Windows 软件，所以尝试安装虚拟机，vmware 同样有 mac 下的...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p><img src="https://blog.niekun.net/usr/uploads/2020/07/2900570012.png" alt="2020-07-03T13:43:03.png" title="2020-07-03T13:43:03.png"><br>在 Windows 下我一直在使用 vmware workstation pro 虚拟机，最近需要在 mac 上使用 Windows 软件，所以尝试安装虚拟机，vmware 同样有 mac 下的产品 vmware fusion，最便捷的方法就是直接导入 workstation 的到 fusion，这样就不需要重新安装系统和软件了。</p><p>官网：<a href="https://www.vmware.com/products/fusion.html">https://www.vmware.com/products/fusion.html</a></p><!--more--><h3>下载</h3><p>首先到官网下载最新版 vmware fusion，目前版本为 11.5：<a href="https://www.vmware.com/products/fusion/fusion-evaluation.html">https://www.vmware.com/products/fusion/fusion-evaluation.html</a></p><h3>安装</h3><p>安装下载的 dmg 文件，安装过程中会要求输入序列号，请自行查找。</p><p>运行 vmware fusion 需要系统 accessibility 的权限，安装完成后请到 <code>system preference - security &amp; privacy</code> 里打开对应权限：<br><img src="https://blog.niekun.net/usr/uploads/2020/07/4104120793.png" alt="2020-07-03T13:35:03.png" title="2020-07-03T13:35:03.png"></p><h3>复制虚拟机</h3><p>把 Windows 下 workstation 的虚拟机文件夹复制到 mac 端，虚拟机文件夹默认在用户目录 document - Virtual Machines 文件夹内，找到需要复制的虚拟机文件夹如：<code>windows 7</code>,然后拷贝到 mac。</p><p>复制到 mac 后给文件夹名添加后缀：<code>.vmwarevm</code>，如：<code>Windows 7.vmwarevm</code>，会自动识别为 fusion 可打开的类型。</p><p>运行 vmware fusion，选择 file - open and run：<br><img src="https://blog.niekun.net/usr/uploads/2020/07/2165730683.png" alt="2020-07-03T13:44:20.png" title="2020-07-03T13:44:20.png"></p><p>在打开的对话框找到重命名后的文件夹，选择 open，会启动虚拟机，如果无法启动提示：<code>Could not open /dev/vmmon: Broken pipe</code>，则是由于 accessibility 权限未打开。请根据上面的方法打开权限，然后重新运行 fusion。</p><p>启动后可以点击上方的设置，进行具体设置：<br><img src="https://blog.niekun.net/usr/uploads/2020/07/514672474.png" alt="2020-07-03T13:49:54.png" title="2020-07-03T13:49:54.png"></p><h3>usb 连接</h3><p>如果无法将 usb 挂在到虚拟机，提示不可识别的设备，则可能是由于没有打开 usb 3.0 兼容。首先关闭虚拟机，打开<code>设置 - usb &amp; Bluetooth - advanced usb options</code>，将下方的 usb capability 切换到 <code>usb 3.1</code>：<br><img src="https://blog.niekun.net/usr/uploads/2020/07/1422211913.png" alt="2020-07-03T13:53:44.png" title="2020-07-03T13:53:44.png"></p><p>重新启动虚拟机测试是否可以正常识别 usb。如果还是无法识别这可能是 windows usb 3.0 驱动没有安装，可以到 intel 官网下载驱动：<a href="https://downloadcenter.intel.com/download/22824/USB-3-0-Driver-Intel-USB-3-0-eXtensible-Host-Controller-Driver-for-Intel-8-9-100-Series-and-C220-C610-Chipset-Family">下载地址</a></p><p>进入虚拟机安装以上驱动，如果安装出错，则可能需要打 KB2533623 系统补丁，可以到微软官网下载补丁：<a href="https://www.microsoft.com/zh-CN/download/details.aspx?id=26767">点我下载</a></p><p>安装好补丁后重启系统，然后安装 usb 驱动，完成后再次将 usb 设备切换到虚拟机测试是否可以正常识别到了：<br><img src="https://blog.niekun.net/usr/uploads/2020/07/3689437433.png" alt="2020-07-03T14:00:01.png" title="2020-07-03T14:00:01.png"></p><p>以上就是 Windows 下 vmware workstation 虚拟机迁移到 mac 下 vmware fusion 的方法。</p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/1575.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/archives/1575.html</wfw:commentRss>
</item>
<item>
<title>pandownload keep alive</title>
<link>https://blog.niekun.net/archives/1553.html</link>
<guid>https://blog.niekun.net/archives/1553.html</guid>
<pubDate>Sat, 18 Apr 2020 21:57:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[下载百度云的资源一直是比较头疼的，限速严重影响到了使用体验，我对百度产品又不太喜欢所以就排除了充值会员的选项。前段时间发了一篇百度云网盘直链获取及下载的文章，但是封锁很严重，基本处于不能用的状态...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p><img src="https://blog.niekun.net/usr/uploads/2020/04/3072236758.png" alt="2020-04-20T13:35:22.png" title="2020-04-20T13:35:22.png"><br>下载百度云的资源一直是比较头疼的，限速严重影响到了使用体验，我对百度产品又不太喜欢所以就排除了充值会员的选项。前段时间发了一篇<a href="https://blog.niekun.net/archives/1443.html">百度云网盘直链获取及下载</a>的文章，但是封锁很严重，基本处于不能用的状态。</p><p>这两天 pandownload 这款百度盘下载器的话题很多。由于服务器被关闭，导致软件打不开。研究了下可以绕过程序启动同服务器的链接正常使用软件。原理就是利用别人备份的 pandownload.com 的网站的内容托管到别的服务器，再将对 pandownload.com 域名的请求解析到对应的服务器地址。</p><!--more--><h3>pandownload app</h3><p>pandownload 只提供了 Windows 版本，这里提供程序的备份：<a href="https://blog.niekun.net/usr/uploads/2020/04/PanDownload_add_temp.zip">PanDownload_add_temp.zip</a></p><h3>网站托管</h3><p>程序启动时会同 pandownload.com 发起请求，感谢有人对网站内容做了备份，这里只需要将网站托管到其他的服务器即可。</p><p>网站备份：<a href="https://github.com/AyagawaSeirin/PandownloadFake">https://github.com/AyagawaSeirin/PandownloadFake</a></p><p>下载仓库到服务器，使用 nginx 监听 pandownload.com 域名的访问:</p><pre><code>server {
    listen        80;
    server_name   pandownload.com;
    root          /path/PandownloadFake;
    index         index.html;

    location / {
        try_files $uri $uri/ =404;
    }
    location /api {
    }
}</code></pre><h3>域名解析</h3><p>网站托管到新的服务器后，就可以将本地 dns 解析到服务器地址了。有很多方法可以实现，这里介绍修改 hosts 文件和 v2ray 的 dns 服务器实现。</p><h4>hosts</h4><p>修改 hosts 文件是最基本的方法，就是强制将某个域名的访问解析到对应的 IP 地址。</p><p>hosts 文件地址：C:\Windows\System32\Drivers\etc\hosts</p><p>打开 hosts 文件，在最后加入如下：</p><pre><code>xxx.xxx.xxx.xxx    pandownload.com
</code></pre><p>解析地址可以填写服务器 IP，如果服务器原本的域名加了 CDN，可以填写 CDN 分配的 IP，隐藏服务器真实地址。也可以直接填写域名。</p><p>修改 hosts 完成后再 cmd 执行下面命令以刷新 dns 缓存：</p><pre><code>ipconfig /flushdns
</code></pre><p>启动 pandownload 查看是否可以启动。</p><h4>配置 v2ray dns 服务器</h4><p>如果正在使用 v2ray，可以配置 dns 服务器来达到同样的效果。</p><p>dns 段添加设置如下：</p><pre><code>{
    &quot;dns&quot;: {
        &quot;hosts&quot;: {
            &quot;domain:pandownload.com&quot;: &quot;xxx.xxx.xxx.xxx&quot;
        }
    }
}</code></pre><p>routing 段添加设置如下：</p><pre><code>{
    &quot;routing&quot;: {
        &quot;domainStrategy&quot;: &quot;IPOnDemand&quot;,
        &quot;rules&quot;: [
            {
                &quot;type&quot;: &quot;field&quot;,
                &quot;domain&quot;: [
                    &quot;pandownload.com&quot;
                ],
                &quot;outboundTag&quot;: &quot;direct-customDNS&quot;
            }
        ]
    }
}</code></pre><p>outbounds 段添加设置如下：</p><pre><code>{
    &quot;outbounds&quot;: [
        {
            &quot;protocol&quot;: &quot;freedom&quot;,
            &quot;settings&quot;: {
                &quot;domainStrategy&quot;: &quot;UseIP&quot;
            },
            &quot;tag&quot;: &quot;direct-customDNS&quot;
        }
    ]
}</code></pre><p>以上 v2ray 配置完成后，需要让 pandownload 走 v2ray 监听的代理地址。修改 <code>PanData\config.ini</code>：</p><pre><code>proxy=127.0.0.1:1082
</code></pre><p>proxy 地址为 v2ray http 监听地址。启动 pandownload 测试是否启动正常。</p><h3>使用</h3><p>网上有人搭建好现成的服务端，自己搭建不方便的话可以直接使用别人搭建好的 hosts 地址：<br>185.199.108.153<br>64.52.84.68</p><p>登录百度账户即可进行下载，这里测试需要设置为<strong>PCS接口</strong>才能正常下载：<br><img src="https://blog.niekun.net/usr/uploads/2020/04/2377157041.png" alt="2020-04-18T14:03:44.png" title="2020-04-18T14:03:44.png"></p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/1553.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/archives/1553.html</wfw:commentRss>
</item>
<item>
<title>Windows 自动运行脚本及自启动设置</title>
<link>https://blog.niekun.net/archives/1550.html</link>
<guid>https://blog.niekun.net/archives/1550.html</guid>
<pubDate>Sun, 12 Apr 2020 21:39:16 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[对于 Windows 下 cmd 命令行执行的命令，可以写一个 bat 脚本，双击直接后台运行：@echo offif &quot;%1&quot; == &quot;h&quot; goto ...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>对于 Windows 下 cmd 命令行执行的命令，可以写一个 bat 脚本，双击直接后台运行：</p><pre><code>@echo off
if &quot;%1&quot; == &quot;h&quot; goto begin
mshta vbscript:createobject(&quot;wscript.shell&quot;).run(&quot;&quot;&quot;%~nx0&quot;&quot; h&quot;,0)(window.close)&amp;&amp;exit
:begin
REM

cd C:\frp
frpc -c frpc.ini

exit</code></pre><p>上面的 cd 开始的两行示例命令修改为需要执行的命令即可，程序会在后台运行，想要关闭可以在任务管理器中找到并结束进程：<code>frpc.exe</code></p><p>需要注意的是需要先 cd 到执行程序目录再写运行命令，不然会出问题。</p><p>将脚本快捷方式放到开机启动文件夹可以实现开机自启动，Windows 10 自启文件夹地址是：<code>%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup</code></p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/1550.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/archives/1550.html</wfw:commentRss>
</item>
<item>
<title>traceroute 路由 IP 查看</title>
<link>https://blog.niekun.net/archives/1376.html</link>
<guid>https://blog.niekun.net/archives/1376.html</guid>
<pubDate>Fri, 20 Mar 2020 09:00:07 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[traceroute 是一种电脑网络工具。它可显示数据包在 IP 网络经过的路由器的 IP 地址。程序是利用增加存活时间（TTL）值来实现其功能的。每当数据包经过一个路由器，其存活时间就会减 1...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>traceroute 是一种电脑网络工具。它可显示数据包在 IP 网络经过的路由器的 IP 地址。</p><p>程序是利用增加存活时间（TTL）值来实现其功能的。每当数据包经过一个路由器，其存活时间就会减 1。当其存活时间是 0 时，主机便取消数据包，并发送一个ICMP TTL数据包给原数据包的发出者。</p><p>traceroute 使用<strong>互联网控制信息协议(ICMP)</strong>实现，ICMP 依靠IP来完成它的任务，它是IP的主要部分。它与传输协议（如TCP和UDP）显著不同：它一般不用于在两点间传输数据。由于协议不同所以本地 http 代理对 traceroute 无效。</p><p>现代 Linux 系统称为 <strong>tracepath</strong>，Windows 系统称为 <strong>tracert</strong>，Windows NT 系统有结合 ping 和 traceroute 的 <strong>pathping</strong> 工具。</p><!--more--><h3>使用</h3><h4>Linux</h4><p>可以使用 tracepath/traceroute 工具来测试，traceroute 可使用 apt 来安装，默认最多检测30个路由节点，超过的话就直接结束：</p><pre><code>root@niekun-bandwagon:~# tracepath github.com
 1?: [LOCALHOST]                                         pmtu 1500
 1:  no reply
 2:  173.254.196.25.static.quadranet.com                   0.980ms
 3:  lax1-fatpipe-1.it7.net                                0.395ms
 4:  69.12.69.1                                            0.539ms asymm  3
 5:  ae12.er4.lax112.us.zip.zayo.com                       0.515ms asymm  4
 6:  ae14.cr2.lax112.us.zip.zayo.com                      26.123ms asymm 11
 7:  ae2.cs1.sjc2.us.eth.zayo.com                         26.180ms asymm 11
 8:  ae3.cs1.sea1.us.eth.zayo.com                         30.307ms asymm 10
 9:  ae1.mcs1.sea1.us.eth.zayo.com                        26.299ms asymm  8</code></pre><pre><code>traceroute to github.com (192.30.255.112), 30 hops max, 60 byte packets
 1  * * *
 2  173.254.196.25.static.quadranet.com (173.254.196.25)  1.172 ms  1.172 ms  1.161 ms
 3  lax1-fatpipe-1.it7.net (69.12.70.234)  0.220 ms lax1-fatpipe-1.it7.net (69.12.70.232)  0.341 ms lax1-fatpipe-1.it7.net (69.12.70.234)  0.193 ms
 4  ae12.er4.lax112.us.zip.zayo.com (64.124.85.221)  0.397 ms  0.422 ms 69.12.69.1 (69.12.69.1)  0.268 ms
 5  ae14.cr2.lax112.us.zip.zayo.com (64.125.30.74)  25.828 ms ae12.er4.lax112.us.zip.zayo.com (64.124.85.221)  0.364 ms  0.345 ms
 6  ae2.cs1.sjc2.us.eth.zayo.com (64.125.28.144)  35.091 ms ae14.cr2.lax112.us.zip.zayo.com (64.125.30.74)  26.043 ms  26.009 ms
 7  ae2.cs1.sjc2.us.eth.zayo.com (64.125.28.144)  34.909 ms  34.889 ms  34.832 ms
 8  ae1.mcs1.sea1.us.eth.zayo.com (64.125.28.133)  28.864 ms  26.124 ms  26.112 ms
 9  ae1.mcs1.sea1.us.eth.zayo.com (64.125.28.133)  28.448 ms  28.416 ms 64.125.188.97.IPYX-243981-001-ZYO.zip.zayo.com (64.125.188.97)  30.797 ms
10  * 64.125.188.97.IPYX-243981-001-ZYO.zip.zayo.com (64.125.188.97)  30.949 ms *
</code></pre><h4>windows</h4><p>可以使用 tracert/pathping 工具来测试，pathping 多显示了个本地 IP，默认最多检测30个路由节点，超过的话就直接结束：</p><pre><code>PS C:\Users\Marco Nie&gt; tracert niekun.net

Tracing route to niekun.net [104.24.97.72]
over a maximum of 30 hops:

  1     5 ms     1 ms     1 ms  OrayBox.lan [27.168.1.1]
  2    67 ms   111 ms    81 ms  192.168.1.1
  3     3 ms     3 ms     4 ms  100.64.16.1
  4     4 ms     3 ms     4 ms  10.226.25.13
  5     9 ms     *        *     219.145.223.105
  6    33 ms    32 ms    33 ms  202.97.65.41
  7     *        *        *     Request timed out.
  8     *       42 ms   131 ms  202.97.12.50
  9   341 ms   197 ms   201 ms  202.97.41.50
 10   237 ms   232 ms   224 ms  202.97.92.45
 11   242 ms   252 ms   238 ms  218.30.54.214
 12   197 ms   195 ms   196 ms  104.24.97.72

Trace complete.</code></pre><pre><code>PS C:\Users\Marco Nie&gt; pathping niekun.net

Tracing route to niekun.net [104.24.97.72]
over a maximum of 30 hops:
  0  Marco-vostro-14.lan [27.168.1.209]
  1  OrayBox.lan [27.168.1.1]
  2  192.168.1.1
  3  100.64.16.1
  4  10.226.25.13
  5  219.145.223.105
  6  202.97.65.41
  7  202.97.34.74
  8     *     202.97.12.50
  9  202.97.41.50
 10  202.97.92.45
 11  218.30.54.214
 12  104.24.97.72

Computing statistics for 300 seconds...</code></pre>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/1376.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/archives/1376.html</wfw:commentRss>
</item>
<item>
<title>Windows 下 VMware 安装 Ubuntu 虚拟机</title>
<link>https://blog.niekun.net/archives/1316.html</link>
<guid>https://blog.niekun.net/archives/1316.html</guid>
<pubDate>Fri, 13 Mar 2020 14:00:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[虽然 Windows 10 自带有 WSL，可以安装 Linux 系统，但是在实际使用中发现还是有很多限制的。所以想要完整的 Linux 系统，还是安装了虚拟机。WSL 开启参考：https:/...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p><img src="https://blog.niekun.net/usr/uploads/2020/03/4046207363.png" alt="2020-03-13T03:42:47.png" title="2020-03-13T03:42:47.png"><br>虽然 Windows 10 自带有 WSL，可以安装 Linux 系统，但是在实际使用中发现还是有很多限制的。所以想要完整的 Linux 系统，还是安装了虚拟机。</p><p>WSL 开启参考：<a href="https://blog.niekun.net/archives/1148.html">https://blog.niekun.net/archives/1148.html</a></p><p>我使用的是 VMware workstation 安装了 Ubuntu 18.04 LTS。安装过程中与遇到了一些问题，需要特别的进行处理，在此做一下记录。</p><!--more--><h3>VMware workstation & Ubuntu</h3><p>官网下载 VMware workstation，需要购买序列号：<a href="https://my.vmware.com/en/web/vmware/info/slug/desktop_end_user_computing/vmware_workstation_pro/15_0">https://my.vmware.com/en/web/vmware/info/slug/desktop_end_user_computing/vmware_workstation_pro/15_0</a></p><p>下载完成后进行安装，然后根据提示重启及输入序列号。</p><p>Ubuntu 18.04 LTS 镜像下载：<a href="http://releases.ubuntu.com/18.04.4/ubuntu-18.04.4-desktop-amd64.iso">http://releases.ubuntu.com/18.04.4/ubuntu-18.04.4-desktop-amd64.iso</a></p><p>镜像下载完成后就可以开始准备安装虚拟机了，点击 <strong>文件 - 新建虚拟机</strong>：<br><img src="https://blog.niekun.net/usr/uploads/2020/03/803409871.png" alt="2020-03-13T03:44:08.png" title="2020-03-13T03:44:08.png"></p><p>选择 <strong>典型</strong> 安装，然后下一步，点击浏览找到 Ubuntu 镜像文件：<br><img src="https://blog.niekun.net/usr/uploads/2020/03/524270280.png" alt="2020-03-13T03:45:23.png" title="2020-03-13T03:45:23.png"></p><p>下面就根据提示设置虚拟机账户密码等信息，完成安装后会自动启动虚拟机，使用刚才设置的用户名密码登录虚拟机。</p><h3>分辨率设置</h3><p>光标退出虚拟机的快捷键是：<strong>ctrl alt</strong>。</p><p>我的主机显示比例是 16:9 的1920 × 1080，开机后显示比例是 16:10 的，所以需要设置下全屏。<br>首先点击<strong>保持纵横比拉伸</strong>来让显示尽量铺满全屏：<br><img src="https://blog.niekun.net/usr/uploads/2020/03/814311686.png" alt="2020-03-13T03:50:01.png" title="2020-03-13T03:50:01.png"></p><p>进入 Ubuntu，点击右下角扩展键：<br><img src="https://blog.niekun.net/usr/uploads/2020/03/2566564433.png" alt="2020-03-13T03:51:06.png" title="2020-03-13T03:51:06.png"></p><p>搜索 displays，然后进入显示设置：<br><img src="https://blog.niekun.net/usr/uploads/2020/03/85659870.png" alt="2020-03-13T03:51:42.png" title="2020-03-13T03:51:42.png"></p><p>选择一个和主机一样比例的分辨率：<br><img src="https://blog.niekun.net/usr/uploads/2020/03/614154685.png" alt="2020-03-13T03:52:31.png" title="2020-03-13T03:52:31.png"></p><p>这样虚拟机就可以全屏了。</p><h3>VMware tools</h3><p>VMware tools 可以让主机和虚拟机实现数据交互，很多功能依赖于 VMware tools，如：<strong>共享文件夹，网络桥接，共享剪贴板</strong>等。</p><p>但是我在安装虚拟机后，VMware tools 安装项是灰色的：<br><img src="https://blog.niekun.net/usr/uploads/2020/03/3527355483.png" alt="2020-03-13T03:56:15.png" title="2020-03-13T03:56:15.png"></p><p>查询后了解到 Linux 的 tools 需要手动安装，官网对 Linux 虚拟机安装 VMware tools  有一篇教程：<a href="https://www.vmware.com/support/ws5/doc/ws_newguest_tools_linux.html">https://www.vmware.com/support/ws5/doc/ws_newguest_tools_linux.html</a></p><p>VMware 安装的时候在安装目录下会有一个 <strong>linux.iso</strong> 文件，这就是 VMware tools 安装镜像，我的路径是：C:Program Files (x86)VMwareVMware Workstationlinux.iso</p><p>首先在虚拟机设置里添加一个新的 cd/dvd，挂载 VMware 安装目录下的 <strong>linux.iso</strong> 镜像：<br><img src="https://blog.niekun.net/usr/uploads/2020/03/704611818.png" alt="2020-03-13T03:59:19.png" title="2020-03-13T03:59:19.png"></p><p>进入 Ubuntu，桌面会有 VMware tools，终端路径是：<code>/media/USERNAME/VMware Tools</code>：<br><img src="https://blog.niekun.net/usr/uploads/2020/03/3384185960.png" alt="2020-03-13T05:26:44.png" title="2020-03-13T05:26:44.png"></p><p>进入 VMware Tools 目录，里面有一个压缩包：VMwareTools-10.3.10-13959562.tar.gz，执行如下命令：</p><pre><code>cd /tmp
tar xvf '/media/USERNAME/VMware Tools/VMwareTools-10.3.10-13959562.tar.gz'
cd vmware-tools-distrib
sudo ./vmware-install.pl</code></pre><p>执行解压目录下的 vmware-install.pl，一路 enter 即可。执行结束后就完成了 VMware Tools 的安装，重启系统。</p><h3>网络设置</h3><p>在虚拟机设置里将网络连接设置为<strong>桥接模式</strong>，这样虚拟机和主机就在一个 IP 网段内，如果不设置为<strong>桥接模式</strong>，虚拟机内可能无法执行一些网络命令，如：mtr：<br><img src="https://blog.niekun.net/usr/uploads/2020/03/61701171.png" alt="2020-03-13T05:35:55.png" title="2020-03-13T05:35:55.png"></p><p>设置完成后重启虚拟机，主机使用命令 <strong>ipconfig</strong> 查看当前 IP：<br><img src="https://blog.niekun.net/usr/uploads/2020/03/531046728.png" alt="2020-03-13T05:43:28.png" title="2020-03-13T05:43:28.png"></p><p>虚拟机使用命令 <strong>ifconfig</strong> 查看当前 IP：<br><img src="https://blog.niekun.net/usr/uploads/2020/03/509130697.png" alt="2020-03-13T05:44:14.png" title="2020-03-13T05:44:14.png"></p><p>两个 IP 在一个网段内则设置成功。</p><h3>共享文件夹</h3><p>根据需要可以设置共享主机文件夹，在虚拟机内可以访问，共享文件夹路径是：<code>/mnt/hgfs</code>：<br><img src="https://blog.niekun.net/usr/uploads/2020/03/2015304740.png" alt="2020-03-13T05:37:34.png" title="2020-03-13T05:37:34.png"></p><p>在虚拟机终端测试访问：<br><img src="https://blog.niekun.net/usr/uploads/2020/03/1702706035.png" alt="2020-03-13T05:40:46.png" title="2020-03-13T05:40:46.png"></p><h3>共享主机代理</h3><p>如果主机设置了代理，虚拟机可以直接共享此代理设置。</p><p>首先设置主机代理端口开放给局域网，如果是显示只监听本地地址则 <code>listen</code> 地址设置为 <code>127.0.0.1</code>，如果开放监听局域网地址，则 <code>listen</code> 地址设置为 <code>0.0.0.0</code> 即可。</p><p>在主机使用命令 ipconfig 查看主机 IP 地址。如果要在虚拟机设置系统代理，在虚拟机 Ubuntu 设置里搜索 proxy，点击 network proxy 手动设置代理地址：<br><img src="https://blog.niekun.net/usr/uploads/2020/03/816700122.png" alt="2020-03-13T05:52:13.png" title="2020-03-13T05:52:13.png"></p><p>如果不想设置系统代理，也可以根据上面的主机地址和端口，在单独的应用程序里设置代理，如浏览器。</p><p>终端代理设置参考我之前的文章，也是使用上面得到的主机 IP 和代理端口：<a href="https://blog.niekun.net/archives/97.html">https://blog.niekun.net/archives/97.html</a></p><p>以上就是我用 VMware workstation 安装 Ubuntu 的过程。</p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/1316.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/archives/1316.html</wfw:commentRss>
</item>
<item>
<title>Windows 10 WSL 不支持 systemd</title>
<link>https://blog.niekun.net/archives/1258.html</link>
<guid>https://blog.niekun.net/archives/1258.html</guid>
<pubDate>Wed, 04 Mar 2020 11:44:25 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[在使用 WSL 中发现无法使用 systemd 指令，会有如下报错信息：System has not been booted with systemd as init system (PID 1...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>在使用 WSL 中发现无法使用 systemd 指令，会有如下报错信息：System has not been booted with systemd as init system (PID 1). Can't operate</p><p>查询后发现 WSL 的确有这个问题：<a href="https://github.com/MicrosoftDocs/WSL/issues/457">https://github.com/MicrosoftDocs/WSL/issues/457</a></p><p>解决方法是用<strong>管理员权限打开 WSL</strong>，然后使用 <code>sudo service</code> 来控制进程，如：</p><pre><code>sudo service nginx start
</code></pre>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/1258.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/archives/1258.html</wfw:commentRss>
</item>
<item>
<title>SSD 安装 Windows 那些事</title>
<link>https://blog.niekun.net/archives/1219.html</link>
<guid>https://blog.niekun.net/archives/1219.html</guid>
<pubDate>Tue, 03 Mar 2020 09:32:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[最近给笔记本买了一块 SSD，重装了一次系统。经过这些天的使用出现的问题，发现了一些需要注意的事项，在此做一下记录。关键词：UEFI GPT ESP MSR 4K]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>最近给笔记本买了一块 SSD，重装了一次系统。经过这些天的使用出现的问题，发现了一些需要注意的事项，在此做一下记录。</p><p>关键词：UEFI GPT ESP MSR 4K</p><!--more--><h3>PE and Windows Image</h3><p>我安装的是 Windows 10 64bit 专业版，使用原版镜像在 PE 下安装。</p><p>我在 U 盘里安装的 PE 是自由天空的优启通 v3.5：<a href="https://www.itsk.com/forum.php?mod=viewthread&tid=404842">https://www.itsk.com/forum.php?mod=viewthread&tid=404842</a></p><p>Windows 10 镜像来自于远景论坛：<a href="http://bbs.pcbeta.com/viewthread-1829879-1-1.html">http://bbs.pcbeta.com/viewthread-1829879-1-1.html</a></p><h3>SSD 格式化</h3><p>安装系统时，首先要进行格式化，使用 U 盘引导进入 PE，打开 DiskGenius 开始格式化，首先将硬盘分区表修改为 GUID partition Table(GPT) 模式，这是较新的分区表模式支持空间更大，在硬盘上右键选择 convert to GPT：<br><img src="https://niekun.net/usr/uploads/2020/03/570919698.png" alt="2020-03-03T01:00:00.png" title="2020-03-03T01:00:00.png"></p><p>然后建立 UEFI 引导分区：ESP MSR，不建立的话无法安装系统，DiskGenius 可以一键建立：<br><img src="https://niekun.net/usr/uploads/2020/03/2603681711.png" alt="2020-03-03T01:04:39.png" title="2020-03-03T01:04:39.png"></p><p>然后根据自己需求，将剩余未分配空间进行分区，我只分了一个区，分区对话框注意把：<strong>对齐到下列扇区整数倍</strong>打勾即可，其他参数保持默认，详细说明参考官方文档：<a href="http://www.diskgenius.cn/exp/about-4k-alignment.php">http://www.diskgenius.cn/exp/about-4k-alignment.php</a>：<br><img src="https://niekun.net/usr/uploads/2020/03/1484745426.png" alt="2020-03-03T01:07:39.png" title="2020-03-03T01:07:39.png"></p><p>然后就可以安装系统了，加载 Windows 10 镜像，进入 resources 文件夹，点击 setup 就可以跟着提示一步步安装啦。</p><h3>系统卡顿分析</h3><p>在使用一段时间后，发现一个严重的问题，系统频繁的开始卡顿。查看资源管理器，CPU/内存/磁盘占用都不是很高，但就是很卡顿。</p><p>于是开始寻找问题所在，可能的原因如下：</p><ul><li>LPM 链接电源管理</li><li>第三方软件引起</li><li>驱动问题</li></ul><h4>关闭 LPM</h4><p>经过网上查询发现，可能是打开了 Link Power Management(LPM) 链接电源管理这一功能导致的。启用这一功能后由于 SSD 频繁的休眠或者该退出休眠的时候不能快速退出导致系统卡顿。</p><p>网上介绍的关闭 LPM 的方法一般是修改注册表，然后打开高级电源管理选项来修改参数，但是也可以使用 Inter 的 Rapid Storage Technology 软件来关闭 LPM，下载 Inter 的 Intel Driver & Support Assistant 助理会安装 RST：<a href="https://www.intel.com/content/www/us/en/support/detect.html">https://www.intel.com/content/www/us/en/support/detect.html</a></p><p>打开 RST 在 performance 选项下点击 disable：<br><img src="https://niekun.net/usr/uploads/2020/03/2721727334.png" alt="2020-03-03T01:15:25.png" title="2020-03-03T01:15:25.png"></p><p>根据提示，重启系统就关闭了 LPM 了，可以使用 TxBENCH 来查看系统启用/禁用的硬盘功能，可以看到 DIPM 为灰色状态：<br><img src="https://niekun.net/usr/uploads/2020/03/3003211300.png" alt="2020-03-03T01:18:30.png" title="2020-03-03T01:18:30.png"></p><p>TxBENCH 下载：<a href="https://www.texim.jp/txbenchus.html">https://www.texim.jp/txbenchus.html</a></p><p>在关闭 LPM 后，问题依然存在，所以我的问题不在这里。</p><h4>第三方软件</h4><p>我在发现这一问题时，安装的软件并不多，而且没有安装什么国产软件，但还是需要排查一下。</p><p>首先关掉第三方软件的相关服务：win R 输入<code>msconfig</code>，在 service 栏 点击下方 <strong>hide all Microsoft services</strong>，然后将剩余的服务都关掉，重新启动系统，这就是干净启动，这就排除第三方软件问题。</p><p>关于 Windows10 卡顿问题，微软社区讨论：<a href="https://answers.microsoft.com/zh-hans/windows/forum/all/%E8%BF%90%E8%A1%8Cwin10%E6%9C%89%E6%98%8E%E6%98%BE/d0a4d832-cba7-4fb0-a826-0f24f6dfe848">如何干净启动</a></p><p>我的问题也不在这里。关闭相关软件服务后，可能导致部分软件不能正常打开，如：vmware。实验过后重新把需要的服务打开。</p><h4>驱动问题</h4><p>由于在这次更换 SSD 时，我也顺便升级了 wifi 模块：<strong>ax200</strong>，这是 Intel 比较新的一款模块，支持 WiFi6，这是蓝牙 WiFi 一体的模块。在安装好系统后，我到 Intel 官网找到了 ax200 Bluetooth 驱动，就安装了。</p><p>今天我再次遇到卡顿严重问题，于是在此检查驱动，在 Intel 官网，我找到了 <a href="https://www.intel.com/content/www/us/en/support/products/189347/network-and-i-o/wireless-networking/intel-wireless-products/intel-wi-fi-6-series/intel-wi-fi-6-ax200.html">ax200 所有的驱动程序</a>，我发现似乎 WiFi 和 Bluetooth 是单独的驱动，问题是否会出在这里了？我重新下载了 WiFi 和蓝牙最新的驱动，然后安装。通过 Intel 的<a href="https://www.intel.cn/content/www/cn/zh/support/intel-driver-support-assistant.html">驱动程序和支持助理</a>这个工具可以检测本机硬件驱动状态。</p><p>我发现 nVidia 的驱动也需要更新下，于是到官网下载了它的<a href="https://www.geforce.cn/drivers">驱动管理软件</a>,安装后可以识别硬件并安装新版驱动。<strong>注意安装好助手后，需要登录 nVidia 账号才能进入软件升级驱动。</strong></p><p>经过这些操作，我还需要测试是否有解决问题，如果还有问题我就晕了。</p><h3>硬盘信息查看&测速</h3><p>硬盘买回来当然想知道是不是全新的，序列号/通电时间/通电次数需要查询下，可以使用 CrystalDiskInfo 来查询：<br><img src="https://niekun.net/usr/uploads/2020/03/4026146706.png" alt="2020-03-03T01:23:39.png" title="2020-03-03T01:23:39.png"></p><p>点击下载：<a href="https://niekun.net/usr/uploads/2020/03/1244213503.zip">CrystalDiskInfo8_4_0.zip</a></p><p>还有就是硬盘测试啦，可以使用 AS_SSD_Benchmark 来测试，左边的两个 OK 表示 4K 对齐没问题：<br><img src="https://niekun.net/usr/uploads/2020/03/1956719663.png" alt="2020-03-03T01:25:55.png" title="2020-03-03T01:25:55.png"></p><p>点击下载：<a href="https://niekun.net/usr/uploads/2020/03/2942255910.zip">AS_SSD_Benchmark.zip</a></p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/1219.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/archives/1219.html</wfw:commentRss>
</item>
<item>
<title>Windows 环境变量</title>
<link>https://blog.niekun.net/archives/1187.html</link>
<guid>https://blog.niekun.net/archives/1187.html</guid>
<pubDate>Fri, 28 Feb 2020 09:11:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[在写一些脚本或软件的时候，需要索引或存储文件到特定的目录，但由于客户机上用户名，磁盘名等各不相同，往往不能很好的通过一个固定链接访问到目标路径。这时候可以使用系统环境变量(Environment...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>在写一些脚本或软件的时候，需要索引或存储文件到特定的目录，但由于客户机上用户名，磁盘名等各不相同，往往不能很好的通过一个固定链接访问到目标路径。这时候可以使用系统环境变量(Environment Variable) 来实现需求。</p><p>如果我要访问用户系统根目录，一般情况下路径为：<code>C:</code>。但是有些人的系统目录在 D 盘，这时候就出错了。如果使用 <code>%SystemDrive%</code> 变量来代表系统目录，就会自动识别系统路径，访问到目标结果。</p><p><strong>下面表格列出常用的环境变量：</strong></p><!--more--><h3>Windows Vista, Windows 7, Windows 8/8.1 and Windows 10</h3><table><tbody><tr><td align="center"><strong>Environment Variable</strong></td><td align="center"><strong>Path</strong></td></tr><tr><td align="center">%ALLUSERSPROFILE%</td><td align="center">C:\ProgramData</td></tr><tr><td align="center">%APPDATA%</td><td align="center">C:\Users\Username\AppData\Roaming</td></tr><tr><td align="center">%COMMONPROGRAMFILES%</td><td align="center">C:\Program Files\Common Files</td></tr><tr><td align="center">%COMMONPROGRAMFILES(x86)%</td><td align="center">C:\Program Files (x86)\Common Files</td></tr><tr><td align="center">%COMSPEC%</td><td align="center">C:\Windows\System32\cmd.exe</td></tr><tr><td align="center">%HOMEDRIVE%</td><td align="center">C:</td></tr><tr><td align="center">%HOMEPATH%</td><td align="center">C:\Users\Username</td></tr><tr><td align="center">%LOCALAPPDATA%</td><td align="center">C:\Users\Username\AppData\Local</td></tr><tr><td align="center">%PROGRAMDATA%</td><td align="center">C:\ProgramData</td></tr><tr><td align="center">%PROGRAMFILES%</td><td align="center">C:\Program Files</td></tr><tr><td align="center">%PROGRAMFILES(X86)%</td><td align="center">C:\Program Files (x86) (only in 64-bit version)</td></tr><tr><td align="center">%PUBLIC%</td><td align="center">C:\Users\Public</td></tr><tr><td align="center">%SystemDrive%</td><td align="center">C:</td></tr><tr><td align="center">%SystemRoot%</td><td align="center">C:\Windows</td></tr><tr><td align="center">%TEMP% and %TMP%</td><td align="center">C:\Users\Username\AppData\Local\Temp</td></tr><tr><td align="center">%USERPROFILE%</td><td align="center">C:\Users\Username</td></tr><tr><td align="center">%WINDIR%</td><td align="center">C:\Windows</td></tr></tbody></table><hr><h3>Windows XP</h3><table><tbody><tr><td align="center"><strong>Environment Variable</strong></td><td align="center"><strong>Path</strong></td></tr><tr><td align="center">%ALLUSERSPROFILE%</td><td align="center">C:\Documents and Settings\All Users</td></tr><tr><td align="center">%APPDATA%</td><td align="center">C:\Documents and Settings\Username\Application Data</td></tr><tr><td align="center">%COMMONPROGRAMFILES%</td><td align="center">C:\Program Files\Common Files</td></tr><tr><td align="center">%COMMONPROGRAMFILES(x86)%</td><td align="center">C:\Program Files (x86)\Common Files</td></tr><tr><td align="center">%COMSPEC%</td><td align="center">C:\Windows\System32\cmd.exe</td></tr><tr><td align="center">%HOMEDRIVE%</td><td align="center">C:</td></tr><tr><td align="center">%HOMEPATH%</td><td align="center">C:\Documents and Settings\Username</td></tr><tr><td align="center">%PROGRAMFILES%</td><td align="center">C:\Program Files</td></tr><tr><td align="center">%PROGRAMFILES(X86)%</td><td align="center">C:\Program Files (x86) (only in 64-bit version)</td></tr><tr><td align="center">%SystemDrive%</td><td align="center">C:</td></tr><tr><td align="center">%SystemRoot%</td><td align="center">C:\Windows</td></tr><tr><td align="center">%TEMP% and %TMP%</td><td align="center">C:\Documents and Settings\Username\Local Settings\Temp</td></tr><tr><td align="center">%USERPROFILE%</td><td align="center">C:\Documents and Settings\Username</td></tr><tr><td align="center">%WINDIR%</td><td align="center">C:\Windows</td></tr></tbody></table>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/1187.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/archives/1187.html</wfw:commentRss>
</item>
<item>
<title>Windows 下编译 boost 静态库</title>
<link>https://blog.niekun.net/archives/1174.html</link>
<guid>https://blog.niekun.net/archives/1174.html</guid>
<pubDate>Thu, 27 Feb 2020 13:39:00 +0800</pubDate>
<dc:creator>admin</dc:creator>
<description><![CDATA[boost 是很流行的一个 c++ 库，他的部分模块使用只需要引用 head 文件即可，部分需要编译链接库才能使用。下面介绍如何编译模块的静态链接库。官方网站：https://www.boost...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p><img src="https://niekun.net/usr/uploads/2020/02/2617505775.png" alt="2020-02-27T01:06:24.png" title="2020-02-27T01:06:24.png"></p><p>boost 是很流行的一个 c++ 库，他的部分模块使用只需要引用 head 文件即可，部分需要编译链接库才能使用。下面介绍如何编译模块的静态链接库。</p><p>官方网站：<a href="https://www.boost.org/">https://www.boost.org/</a><br>开始教程：<a href="https://www.boost.org/doc/libs/1_72_0/more/getting_started/windows.html">https://www.boost.org/doc/libs/1_72_0/more/getting_started/windows.html</a><br>官方编译教程：<a href="https://www.boost.org/doc/libs/1_72_0/more/getting_started/windows.html#prepare-to-use-a-boost-library-binary">https://www.boost.org/doc/libs/1_72_0/more/getting_started/windows.html#prepare-to-use-a-boost-library-binary</a><br>关于 B2 编译系统：<a href="https://boostorg.github.io/build/">https://boostorg.github.io/build/</a><br>关于 Microsoft Visual C++(MSVC) 版本号：<a href="https://en.wikipedia.org/wiki/Microsoft_Visual_C%2B%2B#Internal_version_numbering">https://en.wikipedia.org/wiki/Microsoft_Visual_C%2B%2B#Internal_version_numbering</a><br>关于静态库和动态库：</p><!--more--><h3>boost 库下载</h3><p>从官方链接下载最新版 boost 库：<a href="https://www.boost.org/users/download/">https://www.boost.org/users/download/</a></p><p>解压到磁盘目录，最好放置在单独管理软件环境库的目录，方便管理。</p><p>需要编译库文件才能使有的模块如下：</p><pre><code>    - atomic
    - chrono
    - container
    - context
    - contract
    - coroutine
    - date_time
    - exception
    - fiber
    - filesystem
    - graph
    - graph_parallel
    - headers
    - iostreams
    - locale
    - log
    - math
    - mpi
    - program_options
    - python
    - random
    - regex
    - serialization
    - stacktrace
    - system
    - test
    - thread
    - timer
    - type_erasure
    - wave</code></pre><h3>编译器配置</h3><p>各平台支持的编译器类型：<a href="https://www.boost.org/doc/libs/1_72_0/more/getting_started/windows.html#identify-your-toolset">https://www.boost.org/doc/libs/1_72_0/more/getting_started/windows.html#identify-your-toolset</a></p><p>Windows 下支持的编译器是：gcc 和 msvc，我电脑安装的是 visual studio 2019 的 c++ 开发包，所以我使用 msvc 作为编译器。</p><p>使用 msvc 编译，需要在 c++ 开发包的基础上在 visual studio installer 里安装 Windows CRT SDK，不然在执行 bootstrap 时会报错：<br><img src="https://niekun.net/usr/uploads/2020/02/2125873377.png" alt="2020-02-27T01:24:42.png" title="2020-02-27T01:24:42.png"></p><p>booost 支持指定 msvc 版本，所以首先查看我安装的 msvc 版本，可以在 visual studio installer 里查看当前安装的 msvc：<br><img src="https://niekun.net/usr/uploads/2020/02/67995277.png" alt="2020-02-27T01:23:36.png" title="2020-02-27T01:23:36.png"></p><p>或者可以通过 VS 版本号来查询 msvc 版本：<a href="https://en.wikipedia.org/wiki/Microsoft_Visual_C%2B%2B#Internal_version_numbering">https://en.wikipedia.org/wiki/Microsoft_Visual_C%2B%2B#Internal_version_numbering</a></p><p>打开 boost 文件夹目录下的 bootstrap.bat 可以看到在执行脚本时也可以通过参数指定 msvc 版本：</p><pre><code>SET TOOLSET=msvc

IF &quot;%1&quot;==&quot;gcc&quot; SET TOOLSET=gcc

IF &quot;%1&quot;==&quot;vc71&quot; SET TOOLSET=msvc : 7.1
IF &quot;%1&quot;==&quot;vc8&quot; SET TOOLSET=msvc : 8.0
IF &quot;%1&quot;==&quot;vc9&quot; SET TOOLSET=msvc : 9.0
IF &quot;%1&quot;==&quot;vc10&quot; SET TOOLSET=msvc : 10.0
IF &quot;%1&quot;==&quot;vc11&quot; SET TOOLSET=msvc : 11.0
IF &quot;%1&quot;==&quot;vc12&quot; SET TOOLSET=msvc : 12.0
IF &quot;%1&quot;==&quot;vc14&quot; SET TOOLSET=msvc : 14.0
IF &quot;%1&quot;==&quot;vc141&quot; SET TOOLSET=msvc : 14.1
IF &quot;%1&quot;==&quot;vc142&quot; SET TOOLSET=msvc : 14.2</code></pre><h3>编译模块</h3><p>首先通过 boost 文件夹目录下的 <strong>bootstrap.bat</strong> 来安装 Boost.Build (b2) 编译工具。</p><p>关于什么是 Boost.Build (b2) 参考：<a href="https://boostorg.github.io/build/">https://boostorg.github.io/build/</a></p><p>使用 vc++ 的终端来执行脚本如 native tool cmd，也可以在终端下指定 msvc 版本来编译，将目录 cd 到 boost 目录然后运行 bootstrap，使用 vc142 作为参数：<br><img src="https://niekun.net/usr/uploads/2020/02/3871338465.png" alt="2020-02-27T01:34:41.png" title="2020-02-27T01:34:41.png"></p><p>如果出错，会在 boost 目录下生成 bootstrap.log 文件，查看具体出错信息。</p><p>成功执行后在 boost 目录会有一个 b2.exe 文件，执行 .\b2 --help 可以查看帮助，下面需要这个 b2 来编辑模块库文件。</p><p>再次打开终端，切换到 boost 目录，运行下面的命令：</p><pre><code>cd \TOYOURBOOSTPATH
b2 --toolset=msvc-14.2 link=static runtime-link=static --build-type=complete stage
</code></pre><p><strong>--toolset=msvc-14.2</strong>       定义了编译器名称<br><strong>link=static</strong>               定义了链接库为静态，就是将链接库本身编译为静态的<br><strong>runtime-link=static</strong>       定义了运行链接库为静态，就是程序使用此库打包时为静态的<br><strong>--build-type=complete</strong> 定义了编译所有支持的变种库<br><strong>stage</strong>                 定义了库文件路径：<strong>.\stage\lib</strong>。想要更换其他路径使用 <strong>--stagedir=directory</strong> 参数来定义</p><p>关于 link 和 runtime-link 参考：<a href="https://www.quora.com/What-is-the-difference-between-static-runtime-and-dynamic-linking">https://www.quora.com/What-is-the-difference-between-static-runtime-and-dynamic-linking</a></p><p>其他可用的参数使用 <strong>b2 --help</strong> 来查看。</p><p>成功编译完成后，链接库文件在 <strong>.\stage\lib\</strong> 目录下。</p><h3>boost 库的使用</h3><p>使用 boost 库需要将 head 头文件文件夹和 lib 链接库文件夹在编译器里指定。</p><p>官方手册：<a href="https://www.boost.org/doc/libs/1_72_0/more/getting_started/windows.html#link-your-program-to-a-boost-library">https://www.boost.org/doc/libs/1_72_0/more/getting_started/windows.html#link-your-program-to-a-boost-library</a></p><p>head 文件夹路径：PathTo\boost_1_72_0\boost<br>lib 库文件夹路径：PathTo\boost_1_72_0\stage\lib</p><p><strong>下面介绍在 visual studio 2019 如何使用 boost。</strong></p><p>打开 c++ 项目文件，在右侧 <strong>solution explorer</strong> 中，在项目名右键点击 <strong>properties</strong> 或者 快捷键 alt + enter：<br><img src="https://niekun.net/usr/uploads/2020/02/1425466925.png" alt="2020-02-27T05:27:40.png" title="2020-02-27T05:27:40.png"></p><p>选择 <strong>c/c++ - general</strong>，右侧菜单 <strong>additional include directories</strong> 中输入 boost 根路径：<br><img src="https://niekun.net/usr/uploads/2020/02/2349038897.png" alt="2020-02-27T05:29:56.png" title="2020-02-27T05:29:56.png"></p><p>选择 <strong>linker - general</strong>，右侧菜单 <strong>additional library directories</strong> 中输入 lib 路径，来包含 lib 库文件：<br><img src="https://niekun.net/usr/uploads/2020/02/1912327834.png" alt="2020-02-27T05:33:05.png" title="2020-02-27T05:33:05.png"></p><p>由于我们编译的是静态链接库，所以需要将 runtime library 设置为静态，选择 <strong>c/c++ - code generation</strong>，右侧菜单 <strong>runtime library</strong> 选择 <strong>MT/MTD</strong>，MT 代表 release，MTD 代表 debug：<br><img src="https://niekun.net/usr/uploads/2020/02/2344815031.png" alt="2020-02-27T05:36:13.png" title="2020-02-27T05:36:13.png"></p><p>以上就把 boost 连接到了环境中，使用只需要 include 需要的模块即可，例如：</p><pre><code>#include &quot;boost/filesystem.hpp&quot;

</code></pre>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://blog.niekun.net/archives/1174.html#comments</comments>
<wfw:commentRss>https://blog.niekun.net/feed/archives/1174.html</wfw:commentRss>
</item>
</channel>
</rss>